{{ 
    config(
        materialized='ephemeral'
    ) 
}}

with 
source as (
    select * from {{ source('chewybi', 'order_line_measures') }}
    where ORDER_PLACED_DATE >= current_date - 10 
),
renamed as (
    select
        ORDER_LINE_ID,
        SHIPMENT_TRACKING_NUMBER,
        SHIPMENT_KEY,
        ORDER_KEY,
        ORDER_PLACED_DATE_KEY,
        ORDER_PLACED_TIME_KEY,
        ORDER_PLACED_DATE,
        PRODUCT_KEY,
        CUSTOMER_KEY,
        STORE_KEY,
        FULFILLMENT_CENTER_KEY,
        OPTIMAL_FULFILLMENT_CENTER_KEY,
        BUSINESS_CHANNEL_KEY,
        OFFER_KEY,
        CUSTOMER_ADDRESS_KEY,
        ORDER_SUBMITTED_BY_KEY,
        ORDER_LINE_SHIPPED_DATE_KEY,
        ORDER_LINE_SHIPPED_TIME_KEY,
        ORDER_LINE_SHIPPED_DATE,
        SUBSCRIPTION_KEY,
        ORDER_LINE_SEQUENCE_NUMBER,
        ORDER_LINE_QUANTITY,
        ORDER_LINE_EACH_PRICE,
        ORDER_LINE_TOTAL_PRICE,
        ORDER_LINE_TOTAL_ADJUSTMENT,
        ORDER_LINE_SHIP_CHARGE,
        ORDER_LINE_SHIP_TAX,
        ORDER_LINE_TAX,
        ORDER_LINE_TOTAL_TAX,
        ORDER_LINE_CURRENCY,
        SHIP_MODE_ID,
        ORDER_LINE_INVENTORY_STATUS,
        ORDER_LINE_CREATED_DTTM,
        ORDER_LINE_UPDATED_DTTM,
        ORDER_LINE_PROMISED_AVAILABILITY_DTTM,
        ORDER_LINE_ESTIMATED_AVAILABILITY_DTTM,
        ORDER_LINE_RELEASED_DTTM,
        ORDER_LINE_SHIPPED_DTTM,
        SHIPMENT_SHIPPED_DTTM,
        ORDER_PARENT_ORDER_ID,
        ORDER_ORDER_LINE_STATUS,
        ORDER_LINE_LEDGER_QUANTITY,
        ORDER_LINE_SHIPMENT_QUANTITY,
        PRODUCT_COMPANY_DESCRIPTION,
        CHEWY_PHARMACY_PART_NUMBER,
        ORDER_ORDER_ID,
        ORDER_ITEM_BACKORDER_FLAG,
        LEGAL_COMPANY_DESCRIPTION,
        ORDER_SOURCE_KEY,
        SITE_KEY,
        ORDER_LINE_EACH_WHOLESALE_PRICE,
        ORDER_LINE_WHOLESALE_SERVICE_RATE,
        ORDER_LINE_WHOLESALE_SERVICE_CHARGE,
        ORDER_LINE_TOTAL_WHOLESALE_PRICE,
        ORDER_LINE_WHOLESALE_MERCHANT_EACH_PRICE,
        ORDER_LINE_WHOLESALE_MERCHANT_TOTAL_PRICE,
        ORDER_ITEM_GIFTCARD_FREE_FLAG,
        ORDER_ITEM_BUNDLE_FLAG,
        BUNDLE_PRODUCT_PART_NUMBER,
        BUNDLE_PRODUCT_KEY,
        WISHLIST_ID,
        ORDER_LINE_DELIVERY_DTTM,
        ORIGINAL_PRODUCT_KEY,
        ORIGINAL_ORDER_KEY,
        ORIGINAL_ORDER_LINE_QUANTITY,
        ORDER_LINE_CHEWY_CASH_ADJUSTMENT,
        ORDER_LINE_GC_ADJUSTMENTS,
        ORDER_LINE_TOTAL_ADJUSTMENTS_ACTUAL,
        ORDER_LINE_EACH_PRICE_LOCAL,
        ORDER_LINE_TOTAL_PRICE_LOCAL,
        ORDER_LINE_TOTAL_ADJUSTMENT_LOCAL,
        ORDER_LINE_SHIP_CHARGE_LOCAL,
        ORDER_LINE_SHIP_TAX_LOCAL,
        ORDER_LINE_TAX_LOCAL,
        ORDER_LINE_TOTAL_TAX_LOCAL,
        ORDER_LINE_CHEWY_CASH_ADJUSTMENT_LOCAL,
        ORDER_LINE_GC_ADJUSTMENTS_LOCAL,
        ORDER_LINE_TOTAL_ADJUSTMENTS_ACTUAL_LOCAL,
        PRESCRIPTION_PROVIDER_KEY,
        SUBSCRIPTION_OLA_ID,
        ORDER_LINE_CREATED_DTTM_EST,
        ORDER_LINE_UPDATED_DTTM_EST,
        ORDER_LINE_PROMISED_AVAILABILITY_DTTM_EST,
        ORDER_LINE_ESTIMATED_AVAILABILITY_DTTM_EST,
        ORDER_LINE_SHIPPED_DTTM_EST,
        ORDER_LINE_RELEASED_DTTM_EST,
        SHIPMENT_SHIPPED_DTTM_EST,
        ORDER_LINE_DELIVERY_DTTM_EST,
        ORDER_LINE_LOYALTY_REWARD_EARN_ADJUSTMENT,
        ORDER_LINE_LOYALTY_REWARD_EARN_ADJUSTMENT_LOCAL,
        LOYALTY_REWARD_REDEMPTION_AMOUNT,
        LOYALTY_REWARD_REDEMPTION_AMOUNT_LOCAL,
        ORDER_LINE_PBFRESH_SUBSCRIPTION
    from source
)

select * from renamed