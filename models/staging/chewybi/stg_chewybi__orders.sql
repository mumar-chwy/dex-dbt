{{ 
    config(
        materialized='ephemeral'
    ) 
}}

with 
source as (
    select * from {{ source('chewybi', 'orders') }}
    where order_placed_dttm_est >= current_date - 10
),
renamed as (
    select
        order_key,
        order_id,
        order_status,
        order_first_order_placed_flag,
        order_auto_reorder_flag,
        order_placed_dttm,
        order_placed_dttm_est,
        order_count_of_items,
        order_count_of_items_pharmacy,
        order_count_of_unique_items,
        order_count_of_unique_items_pharmacy,
        order_promotion_used_flag,
        order_remote_ip,
        order_status_description,
        order_shipped_first_item_dttm,
        order_shipped_first_item_dttm_est,
        order_shipped_last_item_dttm,
        order_shipped_last_item_dttm_est,
        order_first_order_shipped_flag,
        order_customer_age_at_order_placed,
        order_customer_age_at_order_shipped,
        order_has_food_flag,
        order_package_count,
        order_package_count_pharmacy,
        order_is_split_flag,
        order_ship_sub_optimal_time_in_transit_flag,
        order_is_replacement_flag,
        customer_id,
        customer_address_id,
        order_cancel_reason,
        order_prescription_order_flag,
        order_contains_pharmacy_flag,
        order_first_auto_reorder_order_placed_flag,
        order_first_auto_reorder_order_shipped_flag,
        order_cancel_dttm,
        order_cancel_dttm_est,
        order_direct_mail_acquisition_flag,
        order_cross_shipped_flag,
        order_auto_reorder_subscription_first_shipped_flag,
        order_auto_reorder_subscription_first_placed_flag,
        order_backorder_flag,
        order_backorder_create_dttm,
        order_backorder_create_dttm_est,
        order_first_order_shipped_flag_network,
        order_first_order_shipped_flag_rx,
        order_first_order_shipped_flag_chewy,
        order_shipped_first_item_dttm_network,
        order_shipped_first_item_dttm_rx,
        order_shipped_first_item_dttm_chewy,
        order_first_auto_reorder_order_shipped_flag_network,
        order_first_auto_reorder_order_shipped_flag_chewy,
        order_first_auto_reorder_order_shipped_flag_rx,
        order_shipped_first_item_dttm_total_rx_retail,
        order_shipped_first_item_dttm_total_rx_petsmart,
        order_shipped_first_item_dttm_total_chewy_inc,
        order_first_order_shipped_flag_rx_retail,
        order_first_order_shipped_flag_rx_petsmart,
        order_first_order_shipped_flag_total_chewy_inc,
        order_auto_reorder_flag_wholesale,
        order_giftcard_purchase_flag,
        order_first_order_shipped_flag_chewypro,
        b2b_order_flag,
        order_giftcard_redeemed_flag,
        order_item_compound_flag,
        orders_contain_pharmacy_coumpound,
        order_first_order_shipped_flag_pharmacy_compound,
        payment_first_complete_dttm,
        payment_first_complete_dttm_est,
        order_giftcard_free_flag,
        order_bundle_included_flag,
        order_free_giftcard_redeemed_flag,
        allocation_id,
        orders_contain_consumables_flag,
        orders_contain_hard_goods_flag,
        orders_contain_specialty_flag,
        orders_contain_healthcare_flag,
        orders_contain_premium_flag,
        orders_contain_merch_class_1_count,
        order_shipped_first_item_dttm_pharmacy_compound,
        order_shipped_first_item_dttm_pharmacy_compound_est,
        order_contains_fresh,
        donation_org_id,
        order_giftcard_discounted_flag,
        gift_card_only_flag,
        order_discounted_giftcard_redeemed_flag,
        order_first_transaction_placed_giftcard_flag,
        ordstat_cancel_comment,
        order_chewy_cash_won_flag,
        order_chewy_cash_redemption_flag,
        order_first_order_shipped_flag_rx_wholesale,
        order_shipped_first_item_dttm_rx_wholesale,
        order_shipped_first_item_dttm_rx_wholesale_est,
        order_first_order_shipped_flag_chewy_wholesale,
        order_shipped_first_item_dttm_chewy_wholesale,
        order_shipped_first_item_dttm_chewy_wholesale_est,
        order_first_order_shipped_flag_rx_virtual_care,
        order_shipped_first_item_dttm_rx_virtual_care,
        order_shipped_first_item_dttm_rx_virtual_care_est,
        virtual_care_flag,
        legal_company_description,
        order_channel_mix,
        promise_delivery_date,
        sub_site_id
    from source
)

select * from renamed