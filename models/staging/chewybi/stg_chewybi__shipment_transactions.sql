{{ 
    config(
        materialized='ephemeral'
    ) 
}}

with source as (
    select *
    from {{ source('chewybi', 'shipment_transactions') }}
    where order_placed_dttm >= current_date - 10
),

renamed as (
    select
        ORDER_ID,
        SHIPMENT_TRACKING_NUMBER,
        FFMCENTER_ID,
        PRIMARY_FFMCENTER_ID,
        SHIPMODE_ID,
        ADDRESS_ID,
        ORDER_PLACED_DTTM,
        RELEASE_FFM_ACKNOWLDEGEMENT_DTTM,
        RELEASE_DTTM,
        WAREHOUSE_TRACKING_PRINT_DTTM,
        WAREHOUSE_PLANNED_PULL_DTTM,
        WAREHOUSE_DIVERTED_DTTM,
        WAREHOUSE_ACTUAL_SHIP_DTTM,
        SHIPMENT_SHIPPED_DTTM,
        RELEASE_PAYMENT_DTTM,
        RELEASE_CUSTOMER_CONFIRM_DTTM,
        BULK_TRACK_SHIP_DTTM,
        BULK_TRACK_ESTIMATED_DELIVERY_DTTM,
        BULK_TRACK_LAST_STATUS_DTTM,
        BULK_TRACK_DELIVERY_DTTM,
        FFMCENTER_NAME,
        CARRIER_CODE,
        RELEASE_STATUS,
        ORDER_AUTOSHIP_INTENTION,
        ORDER_SHIP_AS_COMPLETE,
        POSTCODE,
        PRIMARY_FFMCENTER_NAME,
        PRIMARY_TRANSIT_DAYS,
        PRIMARY_SHIP_ROUTE,
        ACTUAL_SHIP_ROUTE,
        ACTUAL_ZONE,
        ACTUAL_TRANSIT_DAYS,
        ACTUAL_CUTOFF_TIME,
        ACTUAL_PULLTIME,
        SHIPMENT_PLANNED_WEIGHT,
        SHIPMENT_COST,
        SHIPMENT_QUANTITY,
        WAREHOUSE_CONTAINER_TYPE,
        WAREHOUSE_EXPECTED_WEIGHT,
        WAREHOUSE_PULL_STATUS,
        WAREHOUSE_CONTAINER_STATUS,
        BULK_TRACK_PACKAGE_LENGTH,
        BULK_TRACK_PACKAGE_WIDTH,
        BULK_TRACK_PACKAGE_HEIGHT,
        BULK_TRACK_LB_PACKAGE_WEIGHT,
        BULK_TRACK_DELIVERY_ATTEMPT_EXCEPTION,
        BULK_TRACK_LAST_STATUS_CODE_DESCRIPTION,
        DW_CREATE_DTTM,
        DW_UPDATE_DTTM,
        WAREHOUSE_ORDER_NUMBER,
        WAREHOUSE_FINAL_SCAN_DTTM,
        SHIPMENT_INVOICE_NET_CHARGE_AMT,
        SHIPMENT_INVOICE_RESIDENTIAL_DELIVERY_AMOUNT,
        SHIPMENT_INVOICE_FUEL_SURCHARGE_AMOUNT,
        SHIPMENT_INVOICE_GST_AMOUNT,
        SHIPMENT_INVOICE_MISCELLANEOUS1_AMOUNT,
        SHIPMENT_INVOICE_DECLARED_VALUE_AMOUNT,
        SHIPMENT_INVOICE_DELIVERY_DTTM,
        SHIPMENT_INVOICE_ADDRESS_CORRECTION_AMOUNT,
        SHIPMENT_INVOICE_DISCOUNT_AMT,
        SHIPMENT_INVOICE_PICKUP_DT,
        SHIPMENT_INVOICE_ORIGIN_VAT_AMOUNT,
        SHIPMENT_INVOICE_SPECIAL_ADJUSTMENT_AMOUNT,
        SHIPMENT_INVOICE_SAT_AMOUNT,
        SHIPMENT_INVOICE_SIGNATURE_SERVICE_AMOUNT,
        SHIPMENT_INVOICE_ADVANCE_FEE_AMOUNT,
        SHIPMENT_INVOICE_ADDITIONAL_HANDLING_AMOUNT,
        SHIPMENT_INVOICE_FREIGHT_AMT,
        SHIPMENT_INVOICE_MISCELLANEOUS3_AMOUNT,
        SHIPMENT_INVOICE_DUTY_AMOUNT,
        SHIPMENT_INVOICE_EARNED_DISCOUNT_AMOUNT,
        SHIPMENT_INVOICE_INVOICE_DT,
        SHIPMENT_INVOICE_BILL_WEIGHT,
        SHIPMENT_INVOICE_PERFORMANCE_PRICING_DISCOUNT,
        SHIPMENT_INVOICE_AUTOMATION_DISCOUNT,
        SHIPMENT_INVOICE_MISCELLANEOUS2_AMOUNT,
        SHIPMENT_COUNT_OF_ITEMS_IN_BOX,
        SHIPMENT_COUNT_OF_UNIQUE_ITEMS_IN_BOX,
        SHIPMENT_INVOICE_DELIVERY_AREA_SURCHARGE,
        SHIPMENT_TRACKING_INITIAL_ROUTING_LOCATION_CITY,
        SHIPMENT_TRACKING_INITIAL_ROUTING_LOCATION_STATE,
        SHIPMENT_TRACKING_INITIAL_ROUTING_DTTM,
        WAREHOUSE_EXPECTED_LENGTH,
        WAREHOUSE_EXPECTED_WIDTH,
        WAREHOUSE_EXPECTED_HEIGHT,
        WAREHOUSE_SCALE_WEIGHT,
        WAREHOUSE_SCALE_HEIGHT,
        WAREHOUSE_SCALE_LENGTH,
        WAREHOUSE_SCALE_WIDTH,
        WAREHOUSE_WAVE_ID,
        PRIMARY_ZONE,
        WAREHOUSE_CARRIER,
        WAREHOUSE_ACTUAL_SHIP_ROUTE,
        WAREHOUSE_ACTUAL_SHIP_ROUTE_CUTOFF_TIME,
        WAREHOUSE_ACTUAL_TRANSIT_DAYS,
        WAREHOUSE_PLANNED_DIVERT_DESTINATION,
        WAREHOUSE_ACTUAL_DIVERT_DESTINATION,
        INITIAL_DELIVERY_ATTEMPT_DTTM,
        INITIAL_DELIVERY_ADDITIONAL_STATUS_INFO,
        INITIAL_DELIVERY_ATTEMPT_EXCEPTION_CD,
        INITIAL_DELIVERY_EXCEPTION_DTTM,
        MULTIPLE_DELIVERY_DTTM_FLAG,
        SHIPMENT_OFFSET,
        TRANSIT_OFFSET,
        DELIVERY_OFFSET,
        ONTIME_DELIVERY_FLAG,
        JURST_PRIMARY_FF_CENTER_ID,
        JURST_PRIMARY_FF_CENTER_NAME,
        JURST_PRIMARY_SHIP_ROUTE,
        JURST_PRIMARY_TRASNIT_DAYS,
        JURST_PRIMIARY_ZONE,
        OPTIMAL_FF_CENTER_ID,
        OPTIMAL_FF_CENTER_NAME,
        OPTIMAL_SHIP_ROUTE,
        OPTIMAL_TRASNIT_DAYS,
        OPTIMAL_ZONE,
        BULK_TRACK_EVENT_CITY,
        WAREHOUSE_DIVERTED_REASON,
        CONTAINER_DESCRIPTION,
        CONTAINER_WEIGHT,
        CONTAINER_VOLUME,
        CONTAINER_FULL_LENGTH,
        CONTAINER_FULL_WIDTH,
        CONTAINER_FULL_HEIGHT,
        CONTAINER_WEIGHT_CAP,
        CONTAINER_VOLUME_CAP_PERCENTAGE,
        SHIPMENT_ESTIMATED_DELIVERY_DATE,
        ORDER_PARENT_ORDER_ID,
        AUTOSHIP_REMINDER_DTTM,
        AUTOSHIP_SHIP_ESTIMATE_DTTM,
        SHIPMENT_INITIAL_OD_SCAN_DTTM,
        TRAILER_NUMBER,
        TRAILER_CREATED_DATE,
        TRAILER_RELEASED_DATE,
        ROUTE_DAYS_ADDED,
        ZIP_CODE_DAYS_ADDED,
        FC_CLOSED_DAYS_ADDED,
        HOLIDAY_DAYS_ADDED,
        TNT_ADJUSTED_SHIP_DATE_DAYS_ADDED,
        EXPEDITED_DAYS_ADDED,
        ACTUAL_SHIP_DTTM,
        ACTUAL_SHIP_DATE,
        SHIPMENT_HAS_BUNDLE,
        SHIPMENT_PROMISED_DELIVERY_DATE,
        WAREHOUSE_ACTUAL_FFMCENTER_NAME,
        SHIPMENT_SHIP_ROUTE,
        LAST_EXPECTED_DELIVERY_DATE,
        SHIPMENT_STATUS,
        ORDER_MANAGEMENT_SERVICES_FFMCENTER_NAME,
        SHIPMENT_CONTAINS_FRESH,
        SHIPMENT_WAS_LOST,
        SHIPMENT_WAS_DELAYED,
        FIRST_CARRIER_ESTIMATED_DELIVERY_DATE,
        FIRST_CARRIER_ESTIMATED_DELIVERY_EVENT_DTTM,
        LEGAL_COMPANY_DESCRIPTION,
        ORDER_PLACED_DTTM_EST,
        RELEASE_FFM_ACKNOWLDEGEMENT_DTTM_EST,
        RELEASE_DTTM_EST,
        WAREHOUSE_TRACKING_PRINT_DTTM_EST,
        WAREHOUSE_PLANNED_PULL_DTTM_EST,
        WAREHOUSE_DIVERTED_DTTM_EST,
        WAREHOUSE_ACTUAL_SHIP_DTTM_EST,
        WAREHOUSE_FINAL_SCAN_DTTM_EST,
        SHIPMENT_SHIPPED_DTTM_EST,
        RELEASE_PAYMENT_DTTM_EST,
        RELEASE_CUSTOMER_CONFIRM_DTTM_EST,
        BULK_TRACK_SHIP_DTTM_EST,
        BULK_TRACK_ESTIMATED_DELIVERY_DTTM_EST,
        BULK_TRACK_LAST_STATUS_DTTM_EST,
        BULK_TRACK_DELIVERY_DTTM_EST,
        SHIPMENT_INVOICE_DELIVERY_DTTM_EST,
        SHIPMENT_TRACKING_INITIAL_ROUTING_DTTM_EST,
        INITIAL_DELIVERY_ATTEMPT_DTTM_EST,
        AUTOSHIP_REMINDER_DTTM_EST,
        AUTOSHIP_SHIP_ESTIMATE_DTTM_EST,
        SHIPMENT_INITIAL_OD_SCAN_DTTM_EST,
        FIRST_CARRIER_ESTIMATED_DELIVERY_EVENT_DTTM_EST,
        SHIPMENT_INVOICE_PICKUP_DT_EST,
        SHIPMENT_INVOICE_NET_CHARGE_AMT_LOCAL,
        SHIPMENT_INVOICE_FREIGHT_AMT_LOCAL,
        SHIPMENT_INVOICE_DISCOUNT_AMT_LOCAL,
        SHIPMENT_INVOICE_EARNED_DISCOUNT_AMOUNT_LOCAL,
        SHIPMENT_INVOICE_AUTOMATION_DISCOUNT_LOCAL,
        SHIPMENT_INVOICE_PERFORMANCE_PRICING_DISCOUNT_LOCAL,
        SHIPMENT_INVOICE_FUEL_SURCHARGE_AMOUNT_LOCAL,
        SHIPMENT_INVOICE_RESIDENTIAL_DELIVERY_AMOUNT_LOCAL,
        SHIPMENT_INVOICE_DELIVERY_AREA_SURCHARGE_LOCAL,
        SHIPMENT_INVOICE_DECLARED_VALUE_AMOUNT_LOCAL,
        SHIPMENT_INVOICE_SIGNATURE_SERVICE_AMOUNT_LOCAL,
        SHIPMENT_INVOICE_SAT_AMOUNT_LOCAL,
        SHIPMENT_INVOICE_ADDITIONAL_HANDLING_AMOUNT_LOCAL,
        SHIPMENT_INVOICE_ADDRESS_CORRECTION_AMOUNT_LOCAL,
        SHIPMENT_INVOICE_GST_AMOUNT_LOCAL,
        SHIPMENT_INVOICE_DUTY_AMOUNT_LOCAL,
        SHIPMENT_INVOICE_ADVANCE_FEE_AMOUNT_LOCAL,
        SHIPMENT_INVOICE_ORIGIN_VAT_AMOUNT_LOCAL,
        SHIPMENT_INVOICE_MISCELLANEOUS1_AMOUNT_LOCAL,
        SHIPMENT_INVOICE_MISCELLANEOUS2_AMOUNT_LOCAL,
        SHIPMENT_INVOICE_MISCELLANEOUS3_AMOUNT_LOCAL,
        SHIPMENT_INVOICE_SPECIAL_ADJUSTMENT_AMOUNT_LOCAL,
        BULK_TRACK_PACKAGE_LENGTH_METRIC,
        BULK_TRACK_PACKAGE_WIDTH_METRIC,
        BULK_TRACK_PACKAGE_HEIGHT_METRIC,
        BULK_TRACK_LB_PACKAGE_WEIGHT_METRIC
    from source
)

select *
from renamed
